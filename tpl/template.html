<meta charset="utf-8">
<script src="../lib/handlebars.js"></script>
<script id="tomato-list-template" type="text/x-handlebars-template">
    <ul id="todo-list">
        {{#each .}}
        <li>
            <div class="view">
                <input type="checkbox" class="toggle">
                <label>{{todo}}</label>
                <button class="destroy"></button>
            </div>
            <input class="edit" value="{{todo}}">
        </li>
        {{/each}}
    </ul>
</script>
<script>

    var templates = [];
    var source = document.getElementById('tomato-list-template').innerHTML;
    templates['tomato-list'] = Handlebars.compile(source);

    window.addEventListener('message', function(event) {

        var name = event.data.name || 'default';
        switch(name) {
            case 'tomato-list':
                event.source.postMessage({
                    name: name,
                    html: templates[name](event.data.context)
                }, event.origin);
                break;
        }
    });

</script>